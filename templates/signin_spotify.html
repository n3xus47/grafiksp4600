<!doctype html>
<html lang="pl">
<head>
    <!-- Podstawowe meta tagi -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Logowanie - Grafik SP4600</title>
    
    <!-- Arkusz stylów i manifest PWA -->
    <link rel="stylesheet" href="/static/style.css?v={{ range(1000000, 9999999) | random }}">
    <link rel="manifest" href="/static/manifest.json?v={{ range(1000000, 9999999) | random }}">
    
    <!-- Meta tagi PWA - umożliwiają instalację jako aplikacja na telefonie -->
    <meta name="theme-color" content="#dc2626">  <!-- Kolor paska przeglądarki - Orlen red -->
    <meta name="apple-mobile-web-app-capable" content="yes">  <!-- Pełnoekranowa aplikacja na iOS -->
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">  <!-- Styl paska statusu iOS -->
    <meta name="apple-mobile-web-app-title" content="Grafik SP4600">  <!-- Nazwa aplikacji na iOS -->
</head>
<body>
    <main class="spotify-login-main">
        <header class="spotify-login-header">
            <div class="spotify-logo-container">
                <img src="{{ url_for('static', filename='PKN.WA.D.png') }}" alt="Logo Orlen" class="spotify-logo">
            </div>
        </header>
        
        <section class="spotify-login-section">
            <div class="spotify-login-content">
                <div class="spotify-welcome-container">
                    <div class="spotify-welcome-text">
                        <h1 class="spotify-welcome-title">Witaj ponownie</h1>
                    </div>
                    <div class="spotify-spacing"></div>
                    
                    {% if error %}
                    <div class="spotify-error-message">
                        {{ error }}
                    </div>
                    {% endif %}
                    
                    {% with messages = get_flashed_messages(with_categories=true) %}
                        {% if messages %}
                            {% for category, message in messages %}
                                <div class="spotify-error-message">
                                    {{ message }}
                                </div>
                            {% endfor %}
                        {% endif %}
                    {% endwith %}
                    
                    <!-- Google Login jako główny przycisk -->
                    <div class="spotify-login-tabs">
                        <div class="spotify-tab-buttons">
                            <button class="spotify-tab-button active" onclick="switchTab('google')">Google</button>
                            <button class="spotify-tab-button" onclick="switchTab('email')">Email</button>
                        </div>
                        
                        <!-- Email tabs (ukryte domyślnie) -->
                        <div class="spotify-email-tabs" id="email-tabs" style="display: none;">
                            <button class="spotify-tab-button active" onclick="switchEmailTab('login')">Logowanie</button>
                            <button class="spotify-tab-button" onclick="switchEmailTab('register')">Rejestracja</button>
                        </div>
                    </div>
                    
                    <!-- Google Login Tab -->
                    <div id="google-tab" class="spotify-tab-content active">
                        <a href="/login" class="spotify-google-btn">
                            <span class="spotify-btn-icon-wrapper">
                                <svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd" clip-rule="evenodd" d="M22.1 12.2272C22.1 11.5182 22.0364 10.8363 21.9182 10.1818H12.5V14.05H17.8818C17.65 15.3 16.9455 16.3591 15.8864 17.0682V19.5772H19.1182C21.0091 17.8363 22.1 15.2727 22.1 12.2272Z" fill="#4285F4"></path>
                                    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.4998 21.9999C15.1998 21.9999 17.4635 21.1045 19.118 19.5772L15.8862 17.0681C14.9907 17.6681 13.8453 18.0227 12.4998 18.0227C9.89529 18.0227 7.69075 16.2636 6.90439 13.8999H3.56348V16.4908C5.20893 19.759 8.59075 21.9999 12.4998 21.9999Z" fill="#34A853"></path>
                                    <path fill-rule="evenodd" clip-rule="evenodd" d="M6.90455 13.9C6.70455 13.3 6.59091 12.6591 6.59091 12C6.59091 11.3409 6.70455 10.7 6.90455 10.1V7.50909H3.56364C2.88636 8.85909 2.5 10.3864 2.5 12C2.5 13.6136 2.88636 15.1409 3.56364 16.4909L6.90455 13.9Z" fill="#FBBC05"></path>
                                    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.4998 5.97727C13.968 5.97727 15.2862 6.48182 16.3226 7.47273L19.1907 4.60455C17.4589 2.99091 15.1953 2 12.4998 2C8.59075 2 5.20893 4.24091 3.56348 7.50909L6.90439 10.1C7.69075 7.73636 9.89529 5.97727 12.4998 5.97727Z" fill="#EA4335"></path>
                                </svg>
                            </span>
                            Kontynuuj z Google
                        </a>
                    </div>
                    
                    <!-- Email Login/Register Tab -->
                    <div id="email-tab" class="spotify-tab-content">
                        <!-- Login Form -->
                        <div id="email-login-tab" class="spotify-email-tab-content active">
                            <form method="post" action="/signin" class="spotify-form">
                                <div class="spotify-form-group">
                                    <div class="spotify-form-group__label-group">
                                        <label class="spotify-form-group__label" for="login-email">
                                            <span class="spotify-form-group__label-inner">Adres e-mail</span>
                                        </label>
                                    </div>
                                    <input aria-invalid="false" class="spotify-form-input" id="login-email" name="email" type="email" autocapitalize="none" autocomplete="email" spellcheck="false" autocorrect="off" required>
                                </div>
                                
                                <div class="spotify-form-group">
                                    <div class="spotify-form-group__label-group">
                                        <label class="spotify-form-group__label" for="login-password">
                                            <span class="spotify-form-group__label-inner">Hasło</span>
                                        </label>
                                    </div>
                                    <div class="spotify-password-group">
                                        <input aria-invalid="false" class="spotify-form-input" id="login-password" name="password" type="password" autocomplete="current-password" required>
                                        <button type="button" class="spotify-password-toggle" onclick="togglePassword('login-password')">
                                            <svg class="spotify-eye-icon" viewBox="0 0 24 24">
                                                <path fill="currentColor" d="M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z"/>
                                            </svg>
                                        </button>
                                    </div>
                                </div>
                                
                                <button type="submit" class="spotify-primary-btn">
                                    <span class="spotify-btn-inner">Zaloguj się</span>
                                </button>
                            </form>
                        </div>
                        
                        <!-- Register Form -->
                        <div id="email-register-tab" class="spotify-email-tab-content">
                            <form method="post" action="/register" class="spotify-form">
                                <div class="spotify-form-group">
                                    <div class="spotify-form-group__label-group">
                                        <label class="spotify-form-group__label" for="register-name">
                                            <span class="spotify-form-group__label-inner">Imię i nazwisko</span>
                                        </label>
                                    </div>
                                    <input aria-invalid="false" class="spotify-form-input" id="register-name" name="name" type="text" autocomplete="name" required>
                                </div>
                                
                                <div class="spotify-form-group">
                                    <div class="spotify-form-group__label-group">
                                        <label class="spotify-form-group__label" for="register-email">
                                            <span class="spotify-form-group__label-inner">Adres e-mail</span>
                                        </label>
                                    </div>
                                    <input aria-invalid="false" class="spotify-form-input" id="register-email" name="email" type="email" autocapitalize="none" autocomplete="email" spellcheck="false" autocorrect="off" required>
                                </div>
                                
                                <div class="spotify-form-group">
                                    <div class="spotify-form-group__label-group">
                                        <label class="spotify-form-group__label" for="register-password">
                                            <span class="spotify-form-group__label-inner">Hasło</span>
                                        </label>
                                    </div>
                                    <div class="spotify-password-group">
                                        <input aria-invalid="false" class="spotify-form-input" id="register-password" name="password" type="password" autocomplete="new-password" required minlength="8">
                                        <button type="button" class="spotify-password-toggle" onclick="togglePassword('register-password')">
                                            <svg class="spotify-eye-icon" viewBox="0 0 24 24">
                                                <path fill="currentColor" d="M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z"/>
                                            </svg>
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="spotify-form-group">
                                    <div class="spotify-form-group__label-group">
                                        <label class="spotify-form-group__label" for="register-confirm-password">
                                            <span class="spotify-form-group__label-inner">Potwierdź hasło</span>
                                        </label>
                                    </div>
                                    <div class="spotify-password-group">
                                        <input aria-invalid="false" class="spotify-form-input" id="register-confirm-password" name="confirm_password" type="password" autocomplete="new-password" required minlength="8">
                                        <button type="button" class="spotify-password-toggle" onclick="togglePassword('register-confirm-password')">
                                            <svg class="spotify-eye-icon" viewBox="0 0 24 24">
                                                <path fill="currentColor" d="M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z"/>
                                            </svg>
                                        </button>
                                    </div>
                                </div>
                                
                                <button type="submit" class="spotify-primary-btn">
                                    <span class="spotify-btn-inner">Zarejestruj się</span>
                                </button>
                            </form>
                        </div>
                    </div>
                    
                    <div class="spotify-divider">
                        <div class="spotify-divider-line"></div>
                    </div>
                    
                    <div class="spotify-info-message">
                        <p class="spotify-info-text">Aby uzyskać dostęp do systemu, Twój email musi być na liście autoryzowanych użytkowników.</p>
                    </div>
                </div>
            </div>
        </section>
    </main>
    
    <script>
        function switchTab(tabName) {
            // Ukryj wszystkie taby
            document.querySelectorAll('.spotify-tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Usuń aktywną klasę z wszystkich przycisków głównych
            document.querySelectorAll('.spotify-tab-buttons .spotify-tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Pokaż wybrany tab
            document.getElementById(tabName + '-tab').classList.add('active');
            
            // Pokaż/ukryj taby email
            const emailTabs = document.getElementById('email-tabs');
            if (tabName === 'email') {
                emailTabs.style.display = 'flex';
            } else {
                emailTabs.style.display = 'none';
            }
            
            // Dodaj aktywną klasę do wybranego przycisku
            event.target.classList.add('active');
        }
        
        function switchEmailTab(tabName) {
            // Ukryj wszystkie taby email
            document.querySelectorAll('.spotify-email-tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Usuń aktywną klasę z wszystkich przycisków email
            document.querySelectorAll('.spotify-email-tabs .spotify-tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Pokaż wybrany tab
            document.getElementById('email-' + tabName + '-tab').classList.add('active');
            
            // Dodaj aktywną klasę do wybranego przycisku
            event.target.classList.add('active');
        }
        
        function togglePassword(inputId) {
            const input = document.getElementById(inputId);
            const button = input.nextElementSibling;
            const icon = button.querySelector('.spotify-eye-icon');
            
            if (input.type === 'password') {
                input.type = 'text';
                // Zmień ikonę na ukryj
                icon.innerHTML = '<path fill="currentColor" d="M11.83,9L15,12.16C15,12.11 15,12.05 15,12A3,3 0 0,0 12,9C11.94,9 11.89,9 11.83,9M7.53,9.8L9.08,11.35C9.03,11.56 9,11.77 9,12A3,3 0 0,0 12,15C12.22,15 12.44,14.97 12.65,14.92L14.2,16.47C13.53,16.8 12.79,17 12,17A5,5 0 0,1 7,12C7,11.21 7.2,10.47 7.53,9.8M2,4.27L4.28,6.55L4.73,7C3.08,8.3 1.78,10 1,12C2.73,16.39 7,19.5 12,19.5C13.55,19.5 15.03,19.2 16.38,18.66L16.81,19.09L19.73,22L21,20.73L3.27,3M12,7A5,5 0 0,1 17,12C17,12.64 16.87,13.26 16.64,13.82L19.57,16.75C21.07,15.5 22.27,13.86 23,12C21.27,7.61 17,4.5 12,4.5C10.6,4.5 9.26,4.75 8,5.2L10.17,7.35C10.76,7.13 11.37,7 12,7Z"/>';
            } else {
                input.type = 'password';
                // Zmień ikonę na pokaż
                icon.innerHTML = '<path fill="currentColor" d="M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z"/>';
            }
        }
        
        // Walidacja formularza rejestracji
        document.getElementById('register-form').addEventListener('submit', function(e) {
            const form = e.target;
            const password = form.querySelector('input[name="password"]').value;
            const confirmPassword = form.querySelector('input[name="confirm_password"]').value;
            
            if (password !== confirmPassword) {
                e.preventDefault();
                alert('Hasła nie są identyczne!');
                return false;
            }
            
            if (password.length < 8) {
                e.preventDefault();
                alert('Hasło musi mieć co najmniej 8 znaków!');
                return false;
            }
        });
    </script>
</body>
</html>
